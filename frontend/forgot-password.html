<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Forgot Password ‚Äì JSON4AI</title>
  <meta name="description" content="Reset your JSON4AI password."/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css"/>
  <link rel="stylesheet" href="css/aurora-glass.css"/>
  <link rel="stylesheet" href="css/responsive.css"/>
  <script src="https://unpkg.com/heroicons@2.0.18/24/outline/index.js"></script>
  <script src="js/notifications.js" defer></script>
  <script src="js/auth.js" defer></script>
  <script src="js/mobile-nav.js" defer></script>
</head>
<body class="login-body">
<!-- Header -->
<header class="navbar">
  <div class="container flex-between">
    <a href="index.html" class="logo">JSON4<span>AI</span></a>
    <nav class="nav-links" id="nav-links">
      <a href="index.html">Home</a>
      <a href="pricing.html">Pricing</a>
      <a href="login.html">Sign In</a>
    </nav>
    <button id="hamburger" class="hamburger" aria-label="Toggle navigation" aria-expanded="false" aria-controls="nav-links">
      <span></span><span></span><span></span>
    </button>
  </div>
</header>

<!-- Notification Container -->
<div id="notification-container" class="notification-container"></div>

<div class="login-split">
  <!-- Left Panel - Aurora Gradient -->
  <div class="login-left">
    <div class="login-brand">
      <div class="brand-logo">
        <div class="logo-icon">JSON4<span>AI</span></div>
      </div>
      <h2>Reset Your Password</h2>
      <p>Enter your registered email address to receive password reset instructions</p>
      
      <!-- Lottie Animation Container -->
      <div class="lottie-container">
        <lottie-player 
          src="https://lottie.host/653955d6-57e3-4ac8-8a40-59a24381402b/nPXEKn3sXi.lottie" 
          background="transparent" 
          speed="1" 
          style="width: 300px; height: 300px;" 
          loop 
          autoplay>
        </lottie-player>
      </div>
    </div>
  </div>
  
  <!-- Right Panel - Forgot Password Form -->
  <div class="login-right">
    <div class="login-form-container">
      <div class="login-header">
        <div class="logo-small">
          <div class="logo-icon-small">JSON4<span>AI</span></div>
        </div>
        <h1>Forgot Password</h1>
        <p>We'll send you a password reset link to your email address.</p>
      </div>
      
      <!-- Forgot Password Form -->
      <form id="forgot-password-form" class="login-form">
        <div class="form-group">
          <label for="email">Email Address</label>
          <input id="email" name="email" type="email" placeholder="Enter your registered email" required/>
        </div>
        
        <button type="submit" class="submit-btn">Send Reset Link</button>
        
        <div class="login-links">
          <p>Remember your password? <a href="login.html">Sign In</a></p>
          <p>Don't have an account? <a href="register.html">Sign Up</a></p>
        </div>
      </form>
      
      <!-- Success Message (initially hidden) -->
      <div id="success-message" class="success-message" style="display: none;">
        <div class="success-content">
          <h3>
            <svg class="w-6 h-6 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            Check Your Email
          </h3>
          <p>We've sent a password reset link to <strong id="sent-email"></strong></p>
          <p>Click the link in the email to reset your password. The link will expire in 1 hour.</p>
          <button onclick="resendResetEmail()" class="btn-secondary">Resend Email</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Cookie Consent Banner -->
<div id="cookie-consent" class="cookie-consent">
  <div class="cookie-content">
    <div class="cookie-text">
      <h4>üç™ We use cookies to enhance your experience</h4>
      <p>We use cookies and similar technologies to provide, protect, and improve our services. By clicking "Accept All", you consent to our use of cookies for analytics and personalized content. You can customize your preferences or learn more in our <a href="cookies.html" target="_blank">Cookie Policy</a>.</p>
    </div>
    <div class="cookie-actions">
      <button id="cookie-preferences" class="btn-secondary">Customize</button>
      <button id="cookie-accept-all" class="btn-primary">Accept All</button>
    </div>
  </div>
</div>

<!-- Cookie Preferences Modal -->
<div id="cookie-modal" class="cookie-modal">
  <div class="cookie-modal-content">
    <div class="cookie-modal-header">
      <h3>üç™ Cookie Preferences</h3>
      <button id="cookie-modal-close" class="cookie-modal-close">&times;</button>
    </div>
    <div class="cookie-modal-body">
      <div class="cookie-category">
        <div class="cookie-category-header">
          <label class="cookie-toggle">
            <input type="checkbox" id="essential-cookies" checked disabled>
            <span class="cookie-slider"></span>
          </label>
          <div class="cookie-category-info">
            <h4>Essential Cookies</h4>
            <p>Required for the website to function properly. Cannot be disabled.</p>
          </div>
        </div>
      </div>
      
      <div class="cookie-category">
        <div class="cookie-category-header">
          <label class="cookie-toggle">
            <input type="checkbox" id="analytics-cookies">
            <span class="cookie-slider"></span>
          </label>
          <div class="cookie-category-info">
            <h4>Analytics Cookies</h4>
            <p>Help us understand how visitors interact with our website to improve performance.</p>
          </div>
        </div>
      </div>
      
      <div class="cookie-category">
        <div class="cookie-category-header">
          <label class="cookie-toggle">
            <input type="checkbox" id="preference-cookies">
            <span class="cookie-slider"></span>
          </label>
          <div class="cookie-category-info">
            <h4>Preference Cookies</h4>
            <p>Remember your settings and preferences for a personalized experience.</p>
          </div>
        </div>
      </div>
      
      <div class="cookie-category">
        <div class="cookie-category-header">
          <label class="cookie-toggle">
            <input type="checkbox" id="marketing-cookies">
            <span class="cookie-slider"></span>
          </label>
          <div class="cookie-category-info">
            <h4>Marketing Cookies</h4>
            <p>Used to deliver relevant advertisements and track marketing campaign effectiveness.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="cookie-modal-footer">
      <button id="cookie-save-preferences" class="btn-primary">Save Preferences</button>
      <button id="cookie-reject-all" class="btn-secondary">Reject All</button>
    </div>
  </div>
</div>

<script src="js/cookie-consent.js"></script>

<script>
document.getElementById('forgot-password-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const email = document.getElementById('email').value;
  const submitBtn = document.querySelector('.submit-btn');
  const originalText = submitBtn.textContent;
  
  // Show loading state
  submitBtn.textContent = 'Sending...';
  submitBtn.disabled = true;
  
  try {
    const response = await fetch('/api/auth/forgot-password', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ email })
    });
    
    const data = await response.json();
    
    if (response.ok) {
      // Show success message
      document.getElementById('sent-email').textContent = email;
      document.getElementById('forgot-password-form').style.display = 'none';
      document.getElementById('success-message').style.display = 'block';
      
      // Show notification
      showNotification('Password reset email sent successfully!', 'success');
    } else {
      throw new Error(data.message || 'Failed to send reset email');
    }
  } catch (error) {
    console.error('Error:', error);
    showNotification(error.message || 'Failed to send reset email. Please try again.', 'error');
    
    // Reset button state
    submitBtn.textContent = originalText;
    submitBtn.disabled = false;
  }
});

async function resendResetEmail() {
  const email = document.getElementById('sent-email').textContent;
  const resendBtn = document.querySelector('.success-message .btn-secondary');
  const originalText = resendBtn.textContent;
  
  resendBtn.textContent = 'Sending...';
  resendBtn.disabled = true;
  
  try {
    const response = await fetch('/api/auth/forgot-password', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ email })
    });
    
    const data = await response.json();
    
    if (response.ok) {
      showNotification('Reset email resent successfully!', 'success');
    } else {
      throw new Error(data.message || 'Failed to resend email');
    }
  } catch (error) {
    console.error('Error:', error);
    showNotification(error.message || 'Failed to resend email. Please try again.', 'error');
  } finally {
    resendBtn.textContent = originalText;
    resendBtn.disabled = false;
  }
}
</script>

<!-- Footer -->
<footer>
  <div class="container">
    <div class="grid-4">
      <div>
        <h4>JSON4AI</h4>
        <p>Advanced AI prompt generation with JSON structure validation</p>
      </div>
      <div>
        <h4>Product</h4>
        <a href="pricing.html">Pricing</a>
        <a href="prompt-generator.html">Prompt Generator</a>
        <a href="dashboard.html">Dashboard</a>
      </div>
      <div>
        <h4>Company</h4>
        <a href="terms.html">Terms of Service</a>
        <a href="privacy.html">Privacy Policy</a>
        <a href="gdpr.html">GDPR</a>
      </div>
      <div>
        <h4>Support</h4>
        <a href="cookies.html">Cookie Policy</a>
        <a href="mailto:support@json4ai.com">Contact Us</a>
      </div>
    </div>
    <div class="copyright">
      <p>&copy; 2025 JSON4AI. All rights reserved.</p>
    </div>
  </div>
</footer>
</body>
</html>
